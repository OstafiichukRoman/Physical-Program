import streamlit as st

# –û–±–≥–æ—Ä—Ç–∞—î–º–æ –í–°–ï –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ —Ä–∞–º–∫–æ—é
with st.container(border=True):
    st.title("üí• –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä 1D –∑—ñ—Ç–∫–Ω–µ–Ω—å")
    st.write("–†–æ–∑—Ä–∞—Ö–æ–≤—É—î –∫—ñ–Ω—Ü–µ–≤—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ –¥–ª—è –¥–≤–æ—Ö —Ç—ñ–ª –ø—ñ—Å–ª—è –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è.")

    # --- –û–ù–û–í–õ–ï–ù–ò–ô –ë–õ–û–ö –¢–ï–û–†–Ü–á ---
    with st.expander("üìñ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–µ–æ—Ä—ñ—é —Ç–∞ —Ñ–æ—Ä–º—É–ª–∏", expanded=False):
        st.subheader("–ü–æ–∑–Ω–∞—á–µ–Ω–Ω—è")
        st.markdown("""
        * $m_1, m_2$ ‚Äî –º–∞—Å–∏ —Ç—ñ–ª.
        * $v_1, v_2$ ‚Äî —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ç—ñ–ª **–¥–æ** –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è.
        * $v'_1, v'_2$ ‚Äî —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ç—ñ–ª **–ø—ñ—Å–ª—è** –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è.
        """)

        st.subheader("1. –ê–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è")
        st.write("–¢—ñ–ª–∞ –∑–ª–∏–ø–∞—é—Ç—å—Å—è —ñ —Ä—É—Ö–∞—é—Ç—å—Å—è —Ä–∞–∑–æ–º. –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è **—Ç—ñ–ª—å–∫–∏** –∑–∞–∫–æ–Ω –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ–º–ø—É–ª—å—Å—É:")
        st.latex(r"m_1 v_1 + m_2 v_2 = (m_1 + m_2) v'")
        st.write("–ó–≤—ñ–¥—Å–∏ –∫—ñ–Ω—Ü–µ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å $v'$ –¥–æ—Ä—ñ–≤–Ω—é—î:")
        st.latex(r"v' = \frac{m_1 v_1 + m_2 v_2}{m_1 + m_2}")
        st.write("–ß–∞—Å—Ç–∏–Ω–∞ –∫—ñ–Ω–µ—Ç–∏—á–Ω–æ—ó –µ–Ω–µ—Ä–≥—ñ—ó $K$ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —É —Ç–µ–ø–ª–æ, —Ç–æ–º—É $K_{–¥–æ} > K_{–ø—ñ—Å–ª—è}$.")

        st.subheader("2. –ê–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è")
        st.write("–í–∏–∫–æ–Ω—É—é—Ç—å—Å—è **–¥–≤–∞** –∑–∞–∫–æ–Ω–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:")
        st.write("1. –ó–∞–∫–æ–Ω –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ–º–ø—É–ª—å—Å—É:")
        st.latex(r"m_1 v_1 + m_2 v_2 = m_1 v'_1 + m_2 v'_2")
        st.write("2. –ó–∞–∫–æ–Ω –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫—ñ–Ω–µ—Ç–∏—á–Ω–æ—ó –µ–Ω–µ—Ä–≥—ñ—ó:")
        st.latex(r"\frac{m_1 v_1^2}{2} + \frac{m_2 v_2^2}{2} = \frac{m_1 (v'_1)^2}{2} + \frac{m_2 (v'_2)^2}{2}")
        st.write("–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–æ–∑–≤'—è–∑—É—î —Ü—é —Å–∏—Å—Ç–µ–º—É –∑ –¥–≤–æ—Ö —Ä—ñ–≤–Ω—è–Ω—å, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–µ–≤—ñ–¥–æ–º—ñ $v'_1$ —Ç–∞ $v'_2$.")

    # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –≤–≤–æ–¥—É
    with st.form(key='collision_form'):
        st.subheader("–¢—ñ–ª–æ 1 (–ª—ñ–≤–µ)")
        col1, col2 = st.columns(2)
        m1 = col1.number_input("–ú–∞—Å–∞ (m‚ÇÅ), –∫–≥", min_value=0.1, value=1.0)
        v1 = col2.number_input("–ü–æ—á–∞—Ç–∫–æ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å (v‚ÇÅ), –º/—Å", value=10.0, format="%.2f")

        st.subheader("–¢—ñ–ª–æ 2 (–ø—Ä–∞–≤–µ)")
        col3, col4 = st.columns(2)
        m2 = col3.number_input("–ú–∞—Å–∞ (m‚ÇÇ), –∫–≥", min_value=0.1, value=2.0)
        v2 = col4.number_input("–ü–æ—á–∞—Ç–∫–æ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å (v‚ÇÇ), –º/—Å", value=0.0, format="%.2f")

        st.subheader("–¢–∏–ø –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è")
        collision_type = st.radio(
            "–û–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è:",
            ('–ê–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä—É–∂–Ω–µ', '–ê–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä—É–∂–Ω–µ (—Ç—ñ–ª–∞ –∑–ª–∏–ø–∞—é—Ç—å—Å—è)'),
            horizontal=True
        )
        
        submit_button = st.form_submit_button(label='–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏!')

    # --- –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ (–≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏) ---
    if submit_button:
        # –ü–æ—á–∞—Ç–∫–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
        p_initial = m1 * v1 + m2 * v2
        ke_initial = 0.5 * m1 * v1**2 + 0.5 * m2 * v2**2

        if collision_type == '–ê–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä—É–∂–Ω–µ':
            # –†–æ–∑–≤'—è–∑–æ–∫ —Å–∏—Å—Ç–µ–º–∏ —Ä—ñ–≤–Ω—è–Ω—å (–ø—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è)
            v1_prime = ((m1 - m2) * v1 + 2 * m2 * v2) / (m1 + m2)
            v2_prime = ((m2 - m1) * v2 + 2 * m1 * v1) / (m1 + m2)
            
            # –ö—ñ–Ω—Ü–µ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
            p_final = m1 * v1_prime + m2 * v2_prime
            ke_final = 0.5 * m1 * v1_prime**2 + 0.5 * m2 * v2_prime**2

            st.header("–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ (–ü—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è)")
            col_res1, col_res2 = st.columns(2)
            col_res1.metric("–ö—ñ–Ω—Ü–µ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –¢—ñ–ª–∞ 1 (v'‚ÇÅ)", f"{v1_prime:.3f} –º/—Å")
            col_res2.metric("–ö—ñ–Ω—Ü–µ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –¢—ñ–ª–∞ 2 (v'‚ÇÇ)", f"{v2_prime:.3f} –º/—Å")
            
        elif collision_type == '–ê–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä—É–∂–Ω–µ (—Ç—ñ–ª–∞ –∑–ª–∏–ø–∞—é—Ç—å—Å—è)':
            # –†–æ–∑–≤'—è–∑–æ–∫ (–Ω–µ–ø—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è)
            v_prime = (m1 * v1 + m2 * v2) / (m1 + m2) # —î–¥–∏–Ω–∞ –∫—ñ–Ω—Ü–µ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å
            
            # –ö—ñ–Ω—Ü–µ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
            p_final = (m1 + m2) * v_prime
            ke_final = 0.5 * (m1 + m2) * v_prime**2
            
            st.header("–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ (–ù–µ–ø—Ä—É–∂–Ω–µ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è)")
            st.metric("–ö—ñ–Ω—Ü–µ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –æ–±–æ—Ö —Ç—ñ–ª (v')", f"{v_prime:.3f} –º/—Å")

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–∫–æ–Ω—ñ–≤ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        st.subheader("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–∫–æ–Ω—ñ–≤ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è")
        col_p1, col_p2 = st.columns(2)
        col_p1.info(f"–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —ñ–º–ø—É–ª—å—Å: {p_initial:.2f} –∫–≥¬∑–º/—Å")
        col_p2.info(f"–ö—ñ–Ω—Ü–µ–≤–∏–π —ñ–º–ø—É–ª—å—Å: {p_final:.2f} –∫–≥¬∑–º/—Å")

        col_k1, col_k2 = st.columns(2)
        col_k1.warning(f"–ü–æ—á–∞—Ç–∫–æ–≤–∞ –∫—ñ–Ω–µ—Ç–∏—á–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è: {ke_initial:.2f} –î–∂")
        col_k2.warning(f"–ö—ñ–Ω—Ü–µ–≤–∞ –∫—ñ–Ω–µ—Ç–∏—á–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è: {ke_final:.2f} –î–∂")
        
        if collision_type == '–ê–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä—É–∂–Ω–µ (—Ç—ñ–ª–∞ –∑–ª–∏–ø–∞—é—Ç—å—Å—è)':
            st.error(f"**–í—Ç—Ä–∞—Ç–∞ –µ–Ω–µ—Ä–≥—ñ—ó (–ø–µ—Ä–µ–π—à–ª–∞ –≤ —Ç–µ–ø–ª–æ): {ke_initial - ke_final:.2f} –î–∂**")

